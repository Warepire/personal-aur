# $Id$
# Maintainer: Daniel Micay <danielmicay@gmail.com>

pkgname=('termite-git-with-nN-cursor-move-patch')
pkgver=v13.r11.g3e2c10f
pkgrel=1
pkgdesc="A simple VTE-based terminal"
arch=('x86_64')
url="https://github.com/thestinger/termite/"
license=('LGPL')
depends=('vte3-ng-with-nN-cursor-move-patch' 'ncurses') # ncurses now comes with the terminfo file
makedepends=('git' 'vte3-ng-with-nN-cursor-move-patch' 'ncurses')
conflicts=(termite)
provides=(termite)
source=("git+https://github.com/thestinger/termite.git"
        "0001-Move-cursor-along-with-next-prev-search-match-select.patch"
        "0002-Change-TERM-to-termite-instead-of-xterm-termite.patch")
md5sums=('SKIP'
         '9462751cb2591160fc0e6a0561ccbca8'
         'a14c05c4454653ae510bc734e037c7aa')

pkgver() {
  cd termite
  git describe --long | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

prepare() {
  cd termite

  patch -p1 -i ${srcdir}/0001-Move-cursor-along-with-next-prev-search-match-select.patch
  patch -p1 -i ${srcdir}/0002-Change-TERM-to-termite-instead-of-xterm-termite.patch
}

build() {
  cd termite
  git submodule update --init
  make
}

package() {
  backup=(etc/xdg/termite/config)

  cd termite
  make PREFIX=/usr DESTDIR="$pkgdir" install
}
